apiVersion: skaffold/v2beta10
kind: Config
metadata:
  name: k3os-config-operator
build:
  local:
    push: false
profiles:
  - name: release
    build:
      artifacts:
        - image: ghcr.io/annismckenzie/k3os-config-operator
          custom:
            buildCommand: make docker-build
      tagPolicy:
        gitCommit: {}
      local:
        push: true
    deploy:
      kustomize:
        paths:
          - config/default
  - name: tools
    build:
      local:
        push: true
      artifacts:
        - image: ghcr.io/annismckenzie/k3os-config-operator/tools
          custom:
            buildCommand: "TOOLS_IMAGE=${IMAGE} make docker-build-tools"
    deploy: {}
  - name: dev
    build:
      artifacts:
        - image: ghcr.io/annismckenzie/k3os-config-operator
          custom:
            buildCommand: make docker-build-dev
      tagPolicy:
        gitCommit:
          variant: AbbrevTreeSha
          prefix: dev-
      local:
        push: true
    deploy:
      kustomize:
        paths:
          - config/dev
